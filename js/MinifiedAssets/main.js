var restaurants,neighborhoods,cuisines,map,markers=[];document.addEventListener("DOMContentLoaded",function(a){document.getElementById("map-container").style.display="none";updateRestaurants();fetchNeighborhoods();fetchCuisines()});fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(a,c){a?console.error(a):(self.neighborhoods=c,fillNeighborhoodsHTML())})};
fillNeighborhoodsHTML=function(a){a=void 0===a?self.neighborhoods:a;var c=document.getElementById("neighborhoods-select");a.forEach(function(a){var b=document.createElement("option");b.innerHTML=a;b.value=a;c.append(b)})};fetchCuisines=function(){DBHelper.fetchCuisines(function(a,c){a?console.error(a):(self.cuisines=c,fillCuisinesHTML())})};
fillCuisinesHTML=function(a){a=void 0===a?self.cuisines:a;var c=document.getElementById("cuisines-select");a.forEach(function(a){var b=document.createElement("option");b.innerHTML=a;b.value=a;c.append(b)})};window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1});updateRestaurants()};
function displayMap(){"none"==document.getElementById("map-container").style.display?(document.getElementById("toggleMap").value="Hide Map",document.getElementById("map-container").style.display="block",initialize(),updateRestaurants()):(document.getElementById("toggleMap").value="View Map",document.getElementById("map-container").style.display="none")}
function initialize(){var a={zoom:12,center:new google.maps.LatLng(40.722216,-73.987501),scrollwheel:!1};map=new google.maps.Map(document.getElementById("map"),a)}updateRestaurants=function(){var a=document.getElementById("cuisines-select"),c=document.getElementById("neighborhoods-select");DBHelper.fetchRestaurantByCuisineAndNeighborhood(a[a.selectedIndex].value,c[c.selectedIndex].value,function(a,c){a?console.error(a):(resetRestaurants(c),fillRestaurantsHTML())})};
resetRestaurants=function(a){self.restaurants=[];document.getElementById("restaurants-list").innerHTML="";self.markers.forEach(function(a){return a.setMap(null)});self.markers=[];self.restaurants=a};fillRestaurantsHTML=function(a){a=void 0===a?self.restaurants:a;var c=document.getElementById("restaurants-list");a.forEach(function(a){c.append(createRestaurantHTML(a))});addMarkersToMap()};
createRestaurantHTML=function(a){var c=document.createElement("li");c.tabIndex=0;var b=document.createElement("img");b.className="restaurant-img";b.src=DBHelper.imageUrlForRestaurant(a);b.alt="Image of restaurant "+a.name;c.append(b);b=document.createElement("h1");b.innerHTML=a.name;c.append(b);var d=document.createElement("button");d.innerHTML="\u2764";d.classList.add("fav_btn");d.onclick=function(){var b=!a.is_favorite;console.log("isFavNow:"+b);fetch("http://localhost:1337/restaurants/"+a.id+"/?is_favorite="+
b,{method:"PUT"});var c=new Dexie("restaurants1-db");c.version(1).stores({ny:"id"});c.ny.where("id").equals(a.id).modify({is_favorite:b});a.is_favorite=!a.is_favorite;changeFavElementClass(d,a.is_favorite)};changeFavElementClass(d,a.is_favorite);c.append(d);b=document.createElement("p");b.innerHTML=a.neighborhood;c.append(b);b=document.createElement("p");b.innerHTML=a.address;c.append(b);b=document.createElement("a");b.innerHTML="View Details";b.href=DBHelper.urlForRestaurant(a);c.append(b);return c};
changeFavElementClass=function(a,c){c?(a.classList.remove("favorite_no"),a.classList.add("favorite_yes"),a.setAttribute("aria-label","remove as favorite")):(a.classList.remove("favorite_yes"),a.classList.add("favorite_no"),a.setAttribute("aria-label","mark as favorite"))};addMarkersToMap=function(a){a=void 0===a?self.restaurants:a;a.forEach(function(a){var b=DBHelper.mapMarkerForRestaurant(a,self.map);google.maps.event.addListener(b,"click",function(){window.location.href=b.url});self.markers.push(b)})};